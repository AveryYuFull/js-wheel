/*!
 * js-wheel v1.0.7
 * (c) 2017-2018 penyuying
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.Wheel={})}(this,function(e){"use strict";function n(e){console.error("[Wheel warn]: "+e)}function c(e){for(var t=!0,n=0,i=arguments.length,o=Array(1<i?i-1:0),r=1;r<i;r++)o[r-1]=arguments[r];if(o&&o.length<1)return"boolean"==typeof e?{}:e;"boolean"==typeof e&&(t=e,e=o[0],n=1);for(var s=0+n;s<o.length;s++){var l=o[s];if(l instanceof Object)for(var a in l)t&&l[a]instanceof Object?e[a]=c(l[a]instanceof Array?[]:{},l[a]):e[a]=l[a]}return e}var d=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var s,l=e[Symbol.iterator]();!(i=(s=l.next()).done)&&(n.push(s.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};var i=document.createElement("div").style,t=function(){var e={webkit:"webkitTransform",Moz:"MozTransform",O:"OTransform",ms:"msTransform",standard:"transform"};for(var t in e)if(void 0!==i[e[t]])return t;return!1}();function h(e){return!1!==t&&("standard"===t?e:t+e.charAt(0).toUpperCase()+e.substr(1))}var o,g=(o={},"ontouchstart"in window?(o.isTouchable=!0,o.EVENT_START="touchstart",o.EVENT_MOVE="touchmove",o.EVENT_END="touchend"):(o.isTouchable=!1,o.EVENT_START="mousedown",o.EVENT_MOVE="mousemove",o.EVENT_END="mouseup"),o.EVENT_CANCEL="touchcancel",o.EVENT_CLICK="click",o);var r={wheelEl:"",wheelItemEl:"",activeCls:"active",visibleCls:"visible",perspective:"1000px",blurWidth:20,itemHeight:0,itemWidth:0,selectedIndex:0,direction:"vertical"},s=navigator.platform.toLowerCase(),l=navigator.userAgent.toLowerCase(),a=(-1<l.indexOf("iphone")||-1<l.indexOf("ipad")||-1<l.indexOf("ipod"))&&(-1<s.indexOf("iphone")||-1<s.indexOf("ipad")||-1<s.indexOf("ipod"));function f(e,t){(e=this._getElements(e)[0])?this._init(e,t):n("can not resolve the wrapper dom")}f.use=function(e,t){e instanceof Function?e(f,t):e&&e.default instanceof Function?e.default(f,t):n("can not resolve the use module")},f.use(function(e){e.prototype.dispatchEvent=function(e,t,n){if(e&&e.tagName&&t&&"string"==typeof t){var i=document.createEvent(window&&window.MouseEvent?"MouseEvents":"Event");i.initEvent(t,!0,!1),i._constructed=!0,i=c(i,n),e.dispatchEvent(i)}},e.prototype.on=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this,i=this;i._events=i._events||{},i._events[e]=i._events[e]||[],i._events[e].push([t,n])},e.prototype.once=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this,i=this,o=!1;function r(){i.off(e,r),o||(o=!0,t.apply(n,arguments))}r.fn=t,i.on(e,r)},e.prototype.off=function(e,t){var n=this._events[e];if(n)for(var i=n.length;i--;)(n[i][0]===t||n[i][0]&&n[i][0].fn===t)&&(n[i][0]=void 0)},e.prototype.trigger=function(e){var t=this._events&&this._events[e];if(t)for(var n=t.length,i=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t)),o=0;o<n;o++){var r=i[o],s=d(r,2),l=s[0],a=s[1];l&&l.apply(a,[].slice.call(arguments,1))}}}),f.use(function(e){e.prototype._resetItems=function(){var e=this._options,t=this._wheelEl;if(t){var n=this._getElements(e.wheelItemEl,t);n&&0<n.length&&(this._elItems=n)}},e.prototype._initEl=function(e){var t=this,n=t._options;t._el=e,(t._wheelEl=t._getElements(n.wheelEl,e)[0])&&t._bindEvent()},e.prototype._getElements=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document,n=void 0;return e?"string"==typeof e?n=t.querySelectorAll(e):"number"!=typeof e.length&&(n=[e]):t&&t!==document&&t.children&&0<t.children.length&&(n=t.children),n&&0===n.length&&(n=void 0),n&&!(n instanceof Array)&&n.length<1&&(n=[n]),n||[]},e.prototype._calcElementItemPostion=function(){var e=this,t=e._elItems,n=e._options.direction||"vertical";if(t&&0<t.length)for(var i=0;i<t.length;i++){var o=t[i];e.endAngle=e.itemAngle*i,o._index=i,o.angle=e.endAngle,o.style[h("transformOrigin")]="center center -"+e.r+"px",o.style[h("transform")]="translateZ("+e.r+"px) "+("horizontal"==n?"rotateY(":"rotateX(-")+e.endAngle+"deg)"}e.endExceed=e.endAngle+30,e._setItemVisibility(e.beginAngle)},e.prototype._setItemVisibility=function(e){var t=this._elItems,n=this._options,i=n.activeCls,o=n.visibleCls;if(t&&0<t.length)for(var r=0;r<t.length;r++){var s=t[r],l=Math.abs(s.angle-e);l<this.hightlightRange?s.classList.add(i):l<this.visibleRange?(s.classList.add(o),s.classList.remove(i)):(s.classList.remove(i),s.classList.remove(o))}},e.prototype._setAngle=function(e){var t=this._options,n=t.direction||"vertical";this._angle=e,this._wheelEl.style[h("transform")]="perspective("+t.perspective+") "+("horizontal"==n?"rotateY(-":"rotateX(")+e+"deg)",this._setItemVisibility(e)}}),f.use(function(e){e.prototype.getSelectedIndex=function(){var e=this,t=parseInt((e._angle/e.itemAngle).toFixed(0));return e._elItems&&t>e._elItems.length-1&&(t=e._elItems.length-1),t<0&&(t=0),e.index=Math.abs(t)||0,e.index},e.prototype.wheelTo=function(e,t,n){var i=this;i._wheelEl.style[h("transition")]="";var o=i._correctAngle(i.itemAngle*e);if(t&&0<t){var r=o-i._angle;i._scrollDistAngle(Date.now(),i._angle,r,t,n)}else i._setAngle(o),i._triggerEnd(n)},e.prototype._correctAngle=function(e){return e<this.beginAngle?this.beginAngle:e>this.endAngle?this.endAngle:e},e.prototype._startScroll=function(e){var t=this,n=e.changedTouches?e.changedTouches[0]:e,i="horizontal"==(t._options.direction||"vertical")?"pageX":"pageY",o=e.timeStamp||Date.now(),r=(n[i]-t.lastMoveStart)/(o-t.lastMoveTime),s=0<r?-1:1,l=6e-4*s*-1,a=Math.abs(r/l),c=r*a/2,d=t._angle,h=t._calcAngle(c)*s,g=h;d+h<t.beginExceed&&(a=a*((h=t.beginExceed-d)/g)*.6),d+h>t.endExceed&&(a=a*((h=t.endExceed-d)/g)*.6),0!=h?t._scrollDistAngle(o,d,h,a):t._endScroll()},e.prototype._scrollDistAngle=function(e,t,n,i,o){var r,s,l,a,c=this;c.stopInertiaMove=!1,r=t,s=n,l=i/13,a=0,function e(){if(!c.stopInertiaMove){var t,n=-s*((t=(t=a)/l-1)*t*t*t-1)+r;if(c._setAngle(n),l-1<++a||n<c.beginExceed||n>c.endExceed)c._endScroll(o);else{var i=c.getSelectedIndex();c.dispatchEvent(c._el,"scroll",{index:i}),c.trigger("scroll",{index:i}),setTimeout(e,13)}}}()},e.prototype._endScroll=function(e){var t=this,n=t._wheelEl;if(t._angle<t.beginAngle)n.style[h("transition")]="150ms ease-out",t._setAngle(t.beginAngle);else if(t._angle>t.endAngle)n.style[h("transition")]="150ms ease-out",t._setAngle(t.endAngle);else{var i=parseInt((t._angle/t.itemAngle).toFixed(0));n.style[h("transition")]="100ms ease-out",t._setAngle(t.itemAngle*i)}t._triggerEnd(e)},e.prototype._triggerEnd=function(t){var n=this;setTimeout(function(){var e=n.getSelectedIndex();!n.trigger||e==n.lastIndex&&!0!==t||(n.dispatchEvent(n._el,"scrollEnd",{index:e}),n.trigger("scrollEnd",{index:e})),n.lastIndex=e,"function"==typeof t&&t()},0)},e.prototype._calcAngle=function(e){var t=parseFloat(this.r),n=t;e=Math.abs(e);var i=180*parseInt(e/this.d),o=(n*n+t*t-(e%=this.d)*e)/(2*n*t);return i+Math.acos(o)/(Math.PI/180)},e.prototype._initInertiaParams=function(){this.lastMoveTime=0,this.lastMoveStart=0,this.stopInertiaMove=!1},e.prototype._updateInertiaParams=function(e,t){var n=this,i="horizontal"==(n._options.direction||"vertical")?"pageX":"pageY",o=e.changedTouches?e.changedTouches[0]:e;if(t)n.lastMoveStart=o[i],n.lastMoveTime=e.timeStamp||Date.now(),n.startAngle=n._angle;else{var r=e.timeStamp||Date.now();300<r-n.lastMoveTime&&(n.lastMoveTime=r,n.lastMoveStart=o[i])}n.stopInertiaMove=!0},e.prototype._bindEvent=function(){var r=this,e=r._el,s=0,l=null,a=null,c=!1,d="horizontal"==(r._options.direction||"vertical")?"pageX":"pageY";e.addEventListener(g.EVENT_START,function(e){c=!0,e.preventDefault();var t=r.getSelectedIndex();r.dispatchEvent(r._el,"scrollEnd",{index:t}),r.trigger("scrollStart",{index:t}),r._wheelEl.style[h("transition")]="",l=(e.changedTouches?e.changedTouches[0]:e)[d],a=l,s=r._angle,r._updateInertiaParams(e,!0)},!1),e.addEventListener(g.EVENT_END,function(e){c=!1,e.preventDefault(),Math.abs(l-a)<10&&r._triggerEnd(!0),r._startScroll(e)},!1),e.addEventListener(g.EVENT_CANCEL,function(e){c=!1,e.preventDefault(),r._startScroll(e)},!1),e.addEventListener(g.EVENT_MOVE,function(e){if(c){e.preventDefault();var t=(e.changedTouches?e.changedTouches[0]:e)[d],n=(a=t)-l,i=r._calcAngle(n),o=0<n?s-i:s+i;o>r.endExceed&&(o=r.endExceed),o<r.beginExceed&&(o=r.beginExceed),r._setAngle(o),r._updateInertiaParams(e),r.trigger("scroll",{index:r.getSelectedIndex()})}},!1)}}),f.use(function(e){e.prototype.refresh=function(){var e=this,t=e._options,n=e.index,i=e._options.direction||"vertical";e._resetItems();var o=e._elItems;e.height=e._el.offsetHeight,e.width=e._el.offsetWidth;var r=void 0,s=void 0;"horizontal"==i?(e.r=e.width/2-t.blurWidth,s=100,r="Width"):"vertical"!=i&&i||(e.r=e.height/2-t.blurWidth,s=40,r="Height"),e.d=2*e.r,e.itemSize=t["item"+r]||(o&&0<o.length?o[0]["offset"+r]:s),console.log(e.itemSize),e.itemAngle=parseInt(e._calcAngle(.8*e.itemSize)),e.hightlightRange=e.itemAngle/2,e.visibleRange=90,e.beginAngle=0,e.beginExceed=e.beginAngle-30,e._angle=e.beginAngle,a&&(e._wheelEl.style[h("transformOrigin")]="center center "+e.r+"px"),e._calcElementItemPostion(!0),0<n&&e.wheelTo(n)},e.prototype._init=function(e,t){var n=this,i=n._initOptions(t);n._initEl(e),n.refresh(),n.index=i.selectedIndex||0,0<n.index&&n.wheelTo(n.index)},e.prototype._initOptions=function(e){return this._options=c({},r,e),this._options}}),f.Version="1.0.7",e.default=f,e.Wheel=f,Object.defineProperty(e,"__esModule",{value:!0})});